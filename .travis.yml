services:
- docker

env:
  global:
  - secure: "L2aKqrdUqpRSca4bWu1tWtRX8ceFzZmlX5CxEfPPb68fLFUhpqUL/XIdVmA3AtMCPYCl+aHRooSQJGeS/fwS43GupxfE9ACMr4wPRnN2SW5y9ku6uVmEv5EjLCkHmpxxLyo35o9fC5yhNFwSoAdlH4tlfzNgT5LR2JgC6fgVa8vfqZZ542Ink8pE3LuGjnJTqReJAP6WwQb3Nl20yBqaXBJkkwdy4bjqX0Bfv8YNInw/u9l7ykZ4Cr7BC6eG2nl+8GSWv47yJ8XFBbxqnaCA9G36HE77q221T1jWiWhzd4SaVr7B9g8uiZjvJTQvfJE8eaRfcRz/N3c4Nz5CsuiWtNY6kWfU3yoNVO5oQKPFyTK9VYE+5nGxeKGILblxV5uQxz+bR1Sz6TKEpyDXykaKbOUSddBdNXWr1HvEzS/d+hlAfWiEiL7WCX5NEUp9l/G0yaFB+2aPd1qHSyRB8+QAWdc+gyGCQmMNYHfqrvBVj6y6MHWTvkITZIU5smKB7qhw6Ef8uPk93uo0tY2Tpf9emQfybLbRKu+I8IMw9uz8hYvt0dywkXp+oyxcaSysThtBipJEsaEQqUsvhYWDrU2qFWmkuCBZn9oYoGf62PeCP8aAbRitaMpnIQ/U0xQHdCd4o2pA7Mtbhxu1cg/tI8UKjBbDteozrMRlN4i9Qxez/6E="
  - secure: "k/30NvDNSPPa5hGhxiXeJyy+YvQ2r4gbhU8h1Zyi1DzW9uiUIRUS1pPOtan+uWXxkJf0XyhOLudp627690LHqCUiKjXFNCMxqib4NIws4qsfsnGgofAKrvisbJSPDGvgjhDve9e6Ue+Ver59chHroAH/RFuKcKZ4Smcm/VnTnTP5KQiIDSKpNV3eBYW3kJrYJRi3FtSe3nqgfNAs4cWjKBi+kdZunfWJO2Y9+/b+xCcMyQQdbYOQk2etEpPMnWgX33Q0WLXRaoAu7IVsxNCwVmNMpjX48F46M7PgcATLZeFTTj6BxZNNbiF3sNdTXTxeX0fqtustX0U8hrMBt/nPI8teAtflKTBuDWDv50etiAMumU01WPPEJ81X1RwXzK7eD+QdimGzBcSfb0puLTGQrNWL05hcxtnMAA7SplFr/tCHA/kNfYmw16HCfoMNaadsC2JO0pXMtN8nLflCI/ubH2pc+H3p1/HuPHRAPRq/cHUirQXVUlxN+plbA0z2FQzEmARaHTjO17izKsDKN0UuFoDkhSvs5oHeLll7xzCtASbOFRMu/Ch1LXioEiuejCdmbQw9lI4Y1QjKVOQWD+QbDImu4tVl3Nus8ET+qFZ95/lQw9nRMz+7QKxxZlhW+bbuDwS1FUcc163bGfRUv5/d38BIiJ87D00GqCaprP+PRic="
  - secure: "rA9Oyew1glq+khnCTl68bfDeiBorIBMKDzt8g5aQJxUhSmEdv7Rsvv4sIaK9lPuZT0GGRaqiQTxTKNhPxnfW4kjuTrGqcMZYkAdALSTrggFe7oKqThQa93IxPzoQEUYglLgW7EGria1E/rLSzVz6oHIjgmR9WqNdpQkl06jBHQ6/SK4fPHYaKKZWBaPRhniOmZ9WyARr11d6ow1phxTyIfefCi4S72VbclBFJKk9cEN3dTXyr9MEq9rulf9Unizx2sXILMcsBENctA5QOXDCgR+LU3rtBO4cb22jMwEdwuStSTrZo3A/kRzAV2HuWwY9FcNrAV1ENN96hzZvl/NqCbff76J264PI1UHRuUxHJp5nyygGX5wsJsZen8ensvMLoXc0jNY2R7FX2V7PcK+A+9a2pT3pTq9tvETn7XuLunHKnHUUazBs2HnSzmWC1u5WJBovlks+x+mEDRYw5Iz22wFsz28oe3Xk9TzhRW+MLRX8b7hzxB6wFYtbwiqf+zFjfEizxa4IBXFB0FgQcvjzfXJQ7Ty5zEIqr/9dhQGX+M9rAQkSv684Oo24651fImoCuDLaA2n9HwuYzZql6t0rosrFN6dotCLfDmmaFwnyHlJ4jMs61wks2iyhm8tf9z5fxI8VK3U2NAe1uoVc/NWK6Nat10yiSivn3HT2c3gQNSQ="
  - secure: "ZzAya69jW7ctKotkUO08MBdxyauXTtzKU1KdlcOAc7vLhJCxPskMCuOhaoW9LCHngKF4wFoQobAyb6Rkyj/xhaS0B69UeXrLwsphA2UQHLbp7Q7TNxdZRG5IHWd/uMKfY+hcfM/Zb39xGaMtN1O+mlirdRhDcjxzin2xYfyd37Q0r4sw1K3XRZRSAaSFDrhM8X/DC2pgAjaIVgXMgd0N3KqZSJDWusf2sIUYMWdR6nqQ/gTDNlKgWsTvQsKyoI08/y8xo/3YdQptWL0mF262aqU0e54OMeRsrwaK/ZUZi96IWGbpTpv0CTBDnIIfGqMLAPIugiBQK0YrdCyZhfrAuQTNgczV1TCE5wg64T+s78XL/M1eFTa0Un6KGddkBz47nFj8hEt6SxRF5lXz32T8z7dzCMLoOMChMlK99XctWg8DRehbioHLfCgVEun6elVSQwqjD695S1fxI7GmSqgAvXidwNbfXvbnzE+y+cJNJh1TJe5ZlcDeLNcvCuaSUB9xFgfxo6n/qbz0CwumM5phShgxXV18hUr5psOHWL0VZUAG21w1PcfeFx/25nuGpumgMuuvh/e4hvzpeXQXtXeQcoWLLHeoJExQSp1DSmSwrlhNVOYrCybx7KQ+CgrWmACppoHZTENGuHhNKBqcSuSXwcOvpWKv4Cfftz3VGRBzvNE="
  - secure: "ZJgCUfp6VVySsLCjRerJ5POwDlsMiO3b64vGCT67ogwt0+8Qik43UtnrDzK+0SGBsjEKu37O9x/7v1CLe3qRl6vwdY4yiCsDpqgVH9GpR12aGEteQ6jCi10mZhMZuom8fACgz3S08DchLc7rjI+X4wHZVykqq1jC47EkWY+sHSkQDgzH/jcr/xML7cOomzGgXzSrnknZmQP4hAKT9WKx641rrU4WGh0Unt7eBdaqJCekKAiJJ8tu8r9tdbGUd88WXb0AghO1wYym04C5x+ZpSJZywQNszfByyQ7kRd+ABDIl8JwtLgsfvsAabLb9Fq5Y9Q1zq5biH1nfLAELkEyxzB2G6O8SMTrjRO3cDn++A82Ot6HAxhsRhgrAQuz6otWXLKXLMn+yl6gMgdv1iS4tYXAJifnsElC3klWkJOcyguqFjQbGMVnvrNIJ2cdUA6wJFqrzkNuRN6cuKDDLYIo0KM0ICCEH5yLumelx1EzBCJT+UVDlzkfuoSxi/zkW8wxOlykYOzCSM39RZjVN/xUYx0/vQU8wikFPod5uouzN31Hf8TugzEcqKN4MJ+/ou2sNfqOTPDop7HRwhmoF8pQfDxRE5z7o7oEwXgcABzSQkgPoda5X3ecArxd3261s4qHzJdtfuBG+yd5kL05eDYKzteObWBWeOrgWKOwBnH87nQc="
  - secure: "d4NtPyHgynqStDDrE/vBG3BWAM4fJn4x5f7fnfwLmanooYrtC2zd7EAIfTBTnF0e3rgJDJt+3MeLjIlOlBxJddDboUtcQkkEwFayhwnHEvxCnRyPS9oLMmRsmqiSULCA9U5sFtilVRHGDejCWKpoWUagVvzLjga1MlL/dweUR24046VjD0m6javl0i0a0GED9RxARGJo0vlj31jOXJu9RDi2w+0ppkCOxcYeH9+Dzt02yhrpX0s9DTskZzDw4JdUym7W6fA0e06yK9MEOshMgfQOokE1qt3X6fJFKSvds1dnXOrL6+2JyvNyiuc/JRDujP6+Y+whJhhg2hKF91AU/udenT8VdOPQEY94yK3zVtebjjwv08iIZdJ7pGOp76qb3EGZV7rN2kjzum7Ay7sFhmtoTcTPrO/1oIjf4eCxIOPWMr21njPmsUrufBxAjEMuB8M/HR6y9ZPhm+wpHbUU9wD0YhNLS1j9i0sCEaUF6fJMDcPDIHBmvsfGGIN7VTRaMwvgfeFftDakH2Z8Ore8ZZ6j/lxytcbXu4n/pl/JJUXbF8+bw6GZrAguLPrh0qbqQTPJXSzHKBh53+1nTh5s63PDXZ4XXgT9v/ghMyW4AyxNosRvmqjrPAihQiAjSPqKebP1gBJgPJH6WyNLJpnKBirewgulus1t8Q0EVfWSUS8="

script:
- docker build --tag todo-app:test --target test .
- docker run todo-app:test todo_app/Tests/test_items.py
- docker run --env-file .env.test todo-app:test todo_app/Tests/test_app.py
- docker run --env TRELLO_API_BOARD_ID --env TRELLO_API_TOKEN --env TRELLO_API_KEY  todo-app:test todo_app/Selenium_Tests/test_Selenium.py
- echo $DOCKER_PASSWORD | docker login --username $DOCKER_USER --password-stdin
- docker build --target production --tag $DOCKER_USER/todo-app:latest .
- docker push $DOCKER_USER/todo-app:latest
- docker login --username=_ --password=$HEROKU_API_KEY registry.heroku.com

